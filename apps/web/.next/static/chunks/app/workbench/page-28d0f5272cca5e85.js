(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{98748:function(e,s,t){Promise.resolve().then(t.bind(t,84011))},84011:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eW}});var r=t(69245),a=t(69703),l=t(13344),n=t(64439),i=t(90476),o=t(15533),d=t(89619),c=t(26218),m=t(34673),x=t(99615),u=t(57974),h=t(1917);let f=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(x.fC,{ref:s,className:(0,h.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,r.jsx)(x.z$,{className:(0,h.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(u.Z,{className:"h-4 w-4"})})})});f.displayName=x.fC.displayName;var g=t(19118),p=t(73232),j=t(32977),v=t(74067),b=t(38959),N=t(94489),w=t(10724),y=t(69431),k=t(2979),S=t(20739),C=t(89722),z=t(78812);function Z(e){let{folder:s,isExpanded:t,onToggle:l,onCreateSubfolder:n,onRenameFolder:i,onDeleteFolder:o,onSelectSow:x,onMoveSow:u,activeSowId:h,bulkMode:p=!1,selectedItems:j=new Set,onToggleItemSelection:N}=e,[w,y]=(0,a.useState)(!1),[D,A]=(0,a.useState)(s.name),O=()=>{D.trim()&&D.trim()!==s.name&&i(s.id,D.trim()),y(!1)},E=()=>{A(s.name),y(!1)},L=(e,s)=>{e.dataTransfer.setData("text/plain",s)};return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center group",children:[p&&(0,r.jsx)(f,{checked:j.has("folder-".concat(s.id)),onCheckedChange:()=>null==N?void 0:N("folder-".concat(s.id)),className:"mr-2"}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:l,className:"h-6 w-6 p-0 mr-1 hover:bg-muted flex-shrink-0",children:t?(0,r.jsx)(k.Z,{className:"h-3 w-3"}):(0,r.jsx)(S.Z,{className:"h-3 w-3"})}),t?(0,r.jsx)(C.Z,{className:"h-4 w-4 mr-2 text-[#0e2e33] flex-shrink-0"}):(0,r.jsx)(b.Z,{className:"h-4 w-4 mr-2 text-[#0e2e33] flex-shrink-0"}),w?(0,r.jsx)("div",{className:"flex items-center flex-1 min-w-0",children:(0,r.jsx)(m.I,{value:D,onChange:e=>A(e.target.value),onKeyDown:e=>{"Enter"===e.key&&O(),"Escape"===e.key&&E()},className:"text-sm h-6 px-2 flex-1 min-w-0",autoFocus:!0,onBlur:O})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-sm font-medium truncate flex-1 min-w-0",children:s.name}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:[(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>n(s.id),className:"h-5 w-5 p-0 hover:bg-muted hover:shadow-md hover:scale-105 transition-all duration-200",title:"Create subfolder",children:(0,r.jsx)(g.Z,{className:"h-3 w-3"})}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>y(!0),className:"h-5 w-5 p-0 hover:bg-muted hover:shadow-md hover:scale-105 transition-all duration-200",title:"Rename folder",children:(0,r.jsx)(z.Z,{className:"h-3 w-3"})}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>o(s.id),className:"h-5 w-5 p-0 hover:bg-red-500 hover:text-white border border-red-300/20 hover:border-red-500 hover:shadow-lg hover:scale-105 transition-all duration-200",title:"Delete folder",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]})]})]}),t&&(0,r.jsxs)("div",{className:"ml-4 space-y-2 min-h-[2rem] border-l border-border pl-4",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let t=e.dataTransfer.getData("text/plain");t&&u(t,s.id)},children:[s.children.map(e=>(0,r.jsx)(Z,{folder:e,isExpanded:!1,onToggle:()=>{},onCreateSubfolder:n,onRenameFolder:i,onDeleteFolder:o,onSelectSow:x,onMoveSow:u,activeSowId:h},e.id)),s.sows.map(e=>(0,r.jsx)(c.Zb,{className:"m-0 transition-colors ".concat(h===e.id?"ring-2 ring-primary":""),draggable:!p,onDragStart:s=>L(s,e.id),children:(0,r.jsx)(c.aY,{className:"p-2",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[p&&(0,r.jsx)(f,{checked:j.has("sow-".concat(e.id)),onCheckedChange:()=>null==N?void 0:N("sow-".concat(e.id)),className:"mr-2"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",onClick:()=>!p&&x(e.id),children:[(0,r.jsx)("h4",{className:"font-medium text-sm truncate",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.updatedAt).toLocaleDateString()})]})]})})})},e.id)),0===s.children.length&&0===s.sows.length&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground py-2",children:"No SOWs yet. Drag and drop SOWs here."})]})]})}function D(){let e=(0,o.useRouter)(),s=(0,o.usePathname)(),{sows:t,folders:l,isLoading:x,fetchFolders:u,createFolder:h,createSow:k,selectSow:S,renameFolder:C,deleteFolder:D,renameSow:A,deleteSow:O,moveSow:E,activeSow:L,toggleChatPanel:T}=(0,n.m)(),[F,I]=(0,a.useState)(!1),[W,R]=(0,a.useState)(new Set),[M,P]=(0,a.useState)(null),[H,_]=(0,a.useState)(""),[B,U]=(0,a.useState)(new Set),[$,q]=(0,a.useState)(!1);(0,a.useEffect)(()=>{I(!0),u()},[]);let G=(0,a.useCallback)(e=>{R(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},[]),V=e=>{U(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},Y=async()=>{if(0===B.size)return;let e=[],s=[];for(let t of(B.forEach(t=>{t.startsWith("folder-")?e.push(t.replace("folder-","")):t.startsWith("sow-")&&s.push(t.replace("sow-",""))}),e))await D(t);for(let e of s)await O(e);U(new Set),q(!1),await u()},K=F&&document.documentElement.classList.contains("dark")?"/footer-logo.png":"https://i.ibb.co/4gtm4Xm0/Logo-Dark-Green.png";return(0,r.jsxs)("div",{className:"w-64 border-r bg-card",children:[(0,r.jsxs)("div",{className:"p-4 border-b space-y-4",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{onClick:()=>{(null==s?void 0:s.includes("/settings"))||(null==s?void 0:s.includes("/rate-card"))?e.back():e.push("/landing")},className:"cursor-pointer hover:opacity-80 transition-opacity",children:(0,r.jsx)(i.default,{src:K,alt:"Social Garden Logo",width:150,height:40,className:"h-auto w-auto max-w-full",style:{maxHeight:"40px"},priority:!0})})}),(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-center w-full",children:"SOW Workbench"})}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(y.T,{})}),(0,r.jsxs)(d.z,{onClick:async()=>{if(L&&confirm("Are you sure you want to create a new SOW? Make sure your current work is saved.")){let e=await k();await u(),await S(e.id),T()}else if(!L){let e=await k();await u(),await S(e.id),T()}},className:"w-full bg-gradient-to-r from-[#0e2e33] to-[#20e28f] hover:from-[#0e2e33] hover:to-[#1a8c6b] text-white font-bold rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 px-4 py-3",size:"default",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"New SOW"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.z,{onClick:()=>q(!$),variant:"outline",size:"sm",className:"flex-1",children:$?"Cancel":"Select"}),$&&(0,r.jsx)(d.z,{onClick:()=>{if(B.size>0)U(new Set);else{let e=new Set;l.forEach(s=>{e.add("folder-".concat(s.id)),s.children.forEach(s=>{e.add("folder-".concat(s.id))})}),t.forEach(s=>{e.add("sow-".concat(s.id))}),U(e)}},variant:"outline",size:"sm",className:"flex-1",children:B.size>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{className:"h-3 w-3 mr-1"}),"Deselect"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Z,{className:"h-3 w-3 mr-1"}),"Select All"]})})]}),B.size>0&&(0,r.jsxs)(d.z,{onClick:Y,variant:"destructive",size:"sm",className:"w-full",children:[(0,r.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Delete ",B.size," items"]})]}),(0,r.jsx)("div",{className:"p-2 max-h-[calc(100vh-180px)] overflow-y-auto",children:x?(0,r.jsx)("div",{className:"text-center py-4",children:"Loading..."}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 py-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Folders"}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>h("New Folder"),className:"h-6 w-6 p-0 hover:bg-muted",title:"Create new folder",children:(0,r.jsx)(g.Z,{className:"h-3 w-3"})})]}),l.map(e=>(0,r.jsx)(Z,{folder:e,isExpanded:W.has(e.id),onToggle:()=>G(e.id),onCreateSubfolder:e=>h("New Folder",e),onRenameFolder:C,onDeleteFolder:D,onSelectSow:S,onMoveSow:E,activeSowId:null==L?void 0:L.id,bulkMode:$,selectedItems:B,onToggleItemSelection:V},e.id))]}),0===l.length&&(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(b.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,r.jsx)("p",{className:"text-sm",children:"No folders yet"}),(0,r.jsx)("p",{className:"text-xs",children:"Create folders to organize your SOWs"})]}),(0,r.jsxs)(r.Fragment,{children:[(()=>{let e=new Set(l.flatMap(e=>e.sows.map(e=>e.id).concat(e.children.flatMap(e=>e.sows.map(e=>e.id))))),s=t.filter(s=>!e.has(s.id));return s.length>0?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"px-2 py-1",children:(0,r.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:"Unorganized"})}),s.map(e=>(0,r.jsx)(c.Zb,{className:"m-0 transition-colors cursor-pointer ".concat((null==L?void 0:L.id)===e.id?"ring-2 ring-primary bg-primary/5":"hover:bg-muted/50"),draggable:!$,onDragStart:s=>s.dataTransfer.setData("text/plain",e.id),onClick:()=>!$&&S(e.id),children:(0,r.jsx)(c.aY,{className:"p-2 group",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[$&&(0,r.jsx)(f,{checked:B.has("sow-".concat(e.id)),onCheckedChange:()=>V("sow-".concat(e.id)),className:"mr-2"}),(0,r.jsx)("div",{className:"flex-1 min-w-0",children:M===e.id?(0,r.jsx)(m.I,{value:H,onChange:e=>_(e.target.value),onKeyDown:s=>{"Enter"===s.key&&(A(e.id,H.trim()||"Untitled SOW"),P(null)),"Escape"===s.key&&(P(null),_(""))},onBlur:()=>{A(e.id,H.trim()||"Untitled SOW"),P(null)},className:"text-sm h-6 px-2",autoFocus:!0}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-sm truncate",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.updatedAt).toLocaleDateString()})]})})]}),!$&&(0,r.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),P(e.id),_(e.name)},className:"h-6 w-6 p-0 hover:bg-muted",title:"Rename SOW",children:(0,r.jsx)(z.Z,{className:"h-3 w-3"})}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),O(e.id)},className:"h-6 w-6 p-0 hover:bg-destructive hover:text-destructive-foreground",title:"Delete SOW",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]})]})})},e.id))]}):null})(),(0,r.jsx)("div",{className:"min-h-[2rem] border-2 border-dashed border-muted-foreground/30 rounded-md p-2 mt-2",onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();let s=e.dataTransfer.getData("text/plain");s&&E(s,null)},children:(0,r.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Drag SOWs here to remove from folders"})})]})]})}),(0,r.jsxs)("div",{className:"p-2 border-t mt-2 space-y-1 bg-muted/20",children:[(0,r.jsx)(d.z,{variant:"ghost",className:"w-full justify-start",size:"sm",asChild:!0,children:(0,r.jsxs)("a",{href:"/settings/ai",children:[(0,r.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"AI Engine"]})}),(0,r.jsx)(d.z,{variant:"ghost",className:"w-full justify-start",size:"sm",asChild:!0,children:(0,r.jsxs)("a",{href:"/settings/rate-card",children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Rate Card"]})})]})]})}var A=t(90024),O=t(50175),E=t(42835),L=t(88638),T=t(94477),F=t(78714),I=t(82872),W=t(19543),R=t(443),M=t(17950),P=t(56591),H=t(16176),_=t(94620),B=t(56971),U=t(6082),$=t(72846),q=t(49907),G=t(74953),V=t(1791),Y=t(67664),K=t(20709),X=t(70830),J=t(51660),Q=t(38251),ee=t(4545),es=t(26362),et=t(94321);function er(e){let{content:s,onChange:t,placeholder:l="Start typing...",className:n}=e,i=(0,P.jE)({immediatelyRender:!1,extensions:[_.B,B.x,U.n,$.d8,q.Tx,G.v,V.Re,Y.EK,ee.X.configure({levels:[1,2,3]}),K.D,X.G,J.H,Q.V6,es.rU.configure({openOnClick:!1}),et.A,H.V.configure({placeholder:l,showOnlyWhenEditable:!0,showOnlyCurrent:!1})],content:s,onUpdate:e=>{let{editor:s}=e;t(s.getHTML())},editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none p-6 min-h-[300px] text-foreground"}}});return((0,a.useEffect)(()=>{i&&s!==i.getHTML()&&i.commands.setContent(s)},[s,i]),i)?(0,r.jsxs)("div",{className:"border border-input rounded-md bg-card focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 ".concat(n),children:[(0,r.jsxs)("div",{className:"border-b border-border p-2 flex gap-1 flex-wrap bg-card",children:[(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleBold().run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("bold")?"bg-muted":""),type:"button",children:(0,r.jsx)("strong",{children:"B"})}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleItalic().run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("italic")?"bg-muted":""),type:"button",children:(0,r.jsx)("em",{children:"I"})}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleUnderline().run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("underline")?"bg-muted":""),type:"button",children:(0,r.jsx)("span",{className:"underline",children:"U"})}),(0,r.jsx)("div",{className:"w-px bg-border mx-1"}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleHeading({level:1}).run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("heading",{level:1})?"bg-muted":""),type:"button",children:"H1"}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleHeading({level:2}).run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("heading",{level:2})?"bg-muted":""),type:"button",children:"H2"}),(0,r.jsx)("div",{className:"w-px bg-border mx-1"}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleBulletList().run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("bulletList")?"bg-muted":""),type:"button",children:"•"}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleOrderedList().run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("orderedList")?"bg-muted":""),type:"button",children:"1."}),(0,r.jsx)("button",{onClick:()=>i.chain().focus().toggleBlockquote().run(),className:"p-2 rounded text-sm hover:bg-muted ".concat(i.isActive("blockquote")?"bg-muted":""),type:"button",children:'"'})]}),(0,r.jsx)(P.kg,{editor:i})]}):null}function ea(){let{activeSow:e,updateActiveSowData:s}=(0,n.m)(),t=(null==e?void 0:e.sowData)||{},a=(e,r)=>{s({...t,[e]:r})};return e?(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsx)(c.ll,{children:"Basic Information"})}),(0,r.jsxs)(c.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Project Title"}),(0,r.jsx)(m.I,{value:t.projectTitle||"",onChange:e=>a("projectTitle",e.target.value),placeholder:"Project Title"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Client Name"}),(0,r.jsx)(m.I,{value:t.clientName||"",onChange:e=>a("clientName",e.target.value),placeholder:"Client Name"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Project Overview"}),(0,r.jsx)(er,{content:t.projectOverview||"",onChange:e=>a("projectOverview",e),placeholder:"Describe the project in detail - what are you building, why, and what problem does it solve? Use rich formatting to make your overview stand out.",className:"min-h-[200px]"})]})]})]}):null}var el=t(44636),en=t(18535),ei=t(43057),eo=t(6713),ed=t(7492),ec=t(59613);function em(e){let{id:s,children:t}=e,{attributes:a,listeners:l,setNodeRef:n,transform:i,transition:o}=(0,ed.nB)({id:s}),d={transform:ec.ux.Transform.toString(i),transition:o};return(0,r.jsx)("div",{ref:n,style:d,...a,...l,className:"border rounded p-3 mb-3",children:t})}function ex(){let{activeSow:e,rateCard:s,updateActiveSowData:t,updateRoleHours:a,recalculateAllTotals:l}=(0,n.m)(),i=(0,eo.Dy)((0,eo.VT)(eo.we),(0,eo.VT)(eo.Lg,{coordinateGetter:ed.is}));if(!(null==e?void 0:e.sowData))return(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No scopes yet. Add a scope below."});let o=e.sowData,x={projectTitle:(null==o?void 0:o.projectTitle)||"",clientName:(null==o?void 0:o.clientName)||"",projectOverview:(null==o?void 0:o.projectOverview)||"",projectOutcomes:Array.isArray(null==o?void 0:o.projectOutcomes)?o.projectOutcomes:[],scopes:Array.isArray(null==o?void 0:o.scopes)?o.scopes:[],budgetNote:(null==o?void 0:o.budgetNote)||""},u=e=>{t({...x,scopes:e})},h=()=>{u([...Array.isArray(x.scopes)?x.scopes:[],{scopeName:"New Scope",scopeOverview:"",deliverables:[],assumptions:[],roles:[],subtotal:0}])},f=e=>{u(o.scopes.filter((s,t)=>t!==e))},p=(e,s,t)=>{let r=[...o.scopes];if(r[e]={...r[e],[s]:t},"roles"===s){let s=r[e].roles.reduce((e,s)=>e+s.total,0);r[e].subtotal=s}u(r)},j=(e,s)=>{p(e,"deliverables",s)},b=e=>{let s=[...o.scopes[e].assumptions,"New Assumption"];p(e,"assumptions",s)},N=(e,s,t)=>{let r=[...o.scopes[e].assumptions];r[s]=t,p(e,"assumptions",r)},w=(e,s)=>{let t=o.scopes[e].assumptions.filter((e,t)=>t!==s);p(e,"assumptions",t)},y=e=>{let s=[...o.scopes[e].roles,{name:"",description:"",hours:0,rate:0,total:0}];p(e,"roles",s)},k=(s,r,a,n)=>{if(!(null==e?void 0:e.sowData))return;let i=e.sowData;if(!i.scopes||!Array.isArray(i.scopes))return;let o=i.scopes.map((e,t)=>{if(t===s){let s=e.roles.map((e,s)=>{if(s===r){let s="hours"===a||"rate"===a?parseFloat(n)||0:n;return{...e,[a]:s}}return e});return{...e,roles:s}}return e});t({...i,scopes:o}),("rate"===a||"name"===a)&&setTimeout(()=>l(),0)},S=(e,s)=>{let t=o.scopes[e].roles.filter((e,t)=>t!==s);p(e,"roles",t)},C=e=>s=>{let{active:t,over:r}=s;if(!r||t.id===r.id)return;let a=o.scopes[e],l=a.roles.findIndex((e,s)=>s===t.id),n=a.roles.findIndex((e,s)=>s===r.id);p(e,"roles",(0,ed.Rp)(a.roles,l,n))};return o.scopes&&Array.isArray(o.scopes)&&0!==o.scopes.length?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Project Scopes"}),(0,r.jsxs)(d.z,{onClick:h,className:"bg-gradient-to-r from-[#0e2e33] to-[#20e28f] hover:from-[#0e2e33] hover:to-[#1a8c6b] text-white font-bold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"Add Scope"]})]}),o.scopes.map((e,t)=>(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)(c.ll,{className:"text-lg",children:e.scopeName||"Unnamed Scope"}),(0,r.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>f(t),className:"text-destructive hover:bg-red-500 hover:text-white border-red-300/20 hover:border-red-500 hover:shadow-lg transition-all duration-200",children:(0,r.jsx)(v.Z,{className:"h-4 w-4"})})]})}),(0,r.jsxs)(c.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{children:"Scope Name"}),(0,r.jsx)(m.I,{value:e.scopeName,onChange:e=>p(t,"scopeName",e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{children:"Scope Overview"}),(0,r.jsx)(el.g,{value:e.scopeOverview,onChange:e=>p(t,"scopeOverview",e.target.value),placeholder:"Brief description of what this scope covers...",className:"min-h-[200px] text-base"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{children:"Deliverables"}),(0,r.jsx)(er,{content:Array.isArray(e.deliverables)?e.deliverables.join("<br>"):e.deliverables||"",onChange:e=>j(t,e),placeholder:"List all deliverables for this scope...",className:"min-h-[300px]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)(en._,{children:"Assumptions"}),(0,r.jsxs)(d.z,{size:"sm",onClick:()=>b(t),children:[(0,r.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.assumptions.map((e,s)=>(0,r.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,r.jsx)(m.I,{value:e,onChange:e=>N(t,s,e.target.value),placeholder:"Project assumption..."}),(0,r.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>w(t,s),className:"text-destructive hover:text-destructive hover:bg-red-50",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]},s))]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)(en._,{children:"Roles & Pricing"}),(0,r.jsxs)(d.z,{size:"sm",onClick:()=>y(t),children:[(0,r.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Add Role"]})]}),(0,r.jsx)(eo.LB,{sensors:i,collisionDetection:eo.pE,onDragEnd:C(t),children:(0,r.jsx)(ed.Fo,{items:e.roles.map((e,s)=>s),strategy:ed.qw,children:e.roles.map((e,l)=>(0,r.jsx)(em,{id:l,children:(0,r.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,r.jsx)(ei.Z,{className:"h-5 w-5 text-muted-foreground cursor-grab active:cursor-grabbing mt-2 flex-shrink-0"}),(0,r.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{className:"text-sm",children:"Role"}),(0,r.jsxs)("select",{value:e.name,onChange:e=>{let r=s.find(s=>s.name===e.target.value);r&&(k(t,l,"name",r.name),k(t,l,"rate",r.rate))},className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,r.jsx)("option",{value:"",children:"Select role from rate card..."}),s.map(e=>(0,r.jsxs)("option",{value:e.name,children:[e.name," - $",e.rate,"/hr"]},e.id))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{className:"text-sm",children:"Hours"}),(0,r.jsx)(m.I,{type:"number",min:"0",step:"1",value:e.hours||"",onChange:e=>{a(t,l,""===e.target.value?0:parseInt(e.target.value)||0)},placeholder:"0",className:"font-medium bg-background text-foreground"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{className:"text-sm",children:"Rate ($/hr)"}),(0,r.jsx)(m.I,{type:"number",value:e.rate||"",onChange:e=>{k(t,l,"rate",parseFloat(e.target.value)||0)},placeholder:"0",className:"font-medium bg-background text-foreground"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(en._,{className:"text-sm",children:"Total ($)"}),(0,r.jsxs)("div",{className:"h-10 px-3 py-2 border rounded-md font-bold flex items-center text-green-600 dark:text-green-400",children:["$",e.total.toLocaleString()]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Selected: ",e.name]}),(0,r.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>S(t,l),className:"text-destructive hover:text-destructive hover:bg-red-50",children:(0,r.jsx)(v.Z,{className:"h-3 w-3"})})]})]})]})},l))})}),(0,r.jsx)("div",{className:"flex justify-end pt-4 border-t",children:(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Scope Subtotal: "}),(0,r.jsxs)("span",{className:"text-lg font-bold",children:["$",e.subtotal.toLocaleString()]})]})})]})]})]},t)),o.scopes&&o.scopes.length>0&&(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"pt-6",children:(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Project Total: "}),(0,r.jsxs)("span",{className:"text-2xl font-bold text-[#20e28f]",children:["$",o.scopes.reduce((e,s)=>e+s.subtotal,0).toLocaleString()]})]})})})})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Project Scopes"}),(0,r.jsxs)(d.z,{onClick:h,className:"bg-gradient-to-r from-[#0e2e33] to-[#20e28f] hover:from-[#0e2e33] hover:to-[#1a8c6b] text-white font-bold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"Add Scope"]})]}),(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:'No scopes yet. Click "Add Scope" to get started.'})]})}function eu(){let{activeSow:e}=(0,n.m)();return e?(0,r.jsx)("div",{className:"flex-1 overflow-y-auto h-full",children:(0,r.jsxs)("div",{className:"p-6 space-y-6 max-w-4xl mx-auto",children:[(0,r.jsx)(ea,{}),(0,r.jsx)(ex,{})]})}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(T.Z,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"No SOW Selected"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Select an existing SOW from the sidebar or create a new one to get started."})]})})}var eh=t(83912),ef=t(56366),eg=t(55273),ep=t(70688),ej=t(28251),ev=t(66248);function eb(e){let{content:s}=e,[t,l]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"border rounded-md bg-slate-50 dark:bg-slate-800 p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)(d.z,{variant:"ghost",size:"sm",onClick:()=>l(!t),className:"flex items-center gap-1 text-xs",children:[t?"Hide Data":"View Generated SOW Data",t?(0,r.jsx)(ej.Z,{className:"h-3 w-3"}):(0,r.jsx)(k.Z,{className:"h-3 w-3"})]}),(0,r.jsxs)(d.z,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(s)},className:"flex items-center gap-1 text-xs",children:[(0,r.jsx)(ev.Z,{className:"h-3 w-3"}),"Copy"]})]}),t&&(0,r.jsx)(eg.Z,{language:"json",style:ep.Z,className:"!m-0 !p-0 text-xs",children:s})]})}var eN=t(81580),ew=t(72413);let ey=e=>{let{node:s,inline:t,className:l,children:n,...i}=e,[o,d]=(0,a.useState)(!1),c=/language-(\w+)/.exec(l||""),m=c&&"json"===c[1],x=async()=>{try{await navigator.clipboard.writeText(String(n).replace(/\n$/,"")),d(!0),setTimeout(()=>d(!1),2e3)}catch(e){console.error("Failed to copy text: ",e)}};return m?(0,r.jsx)(eb,{content:String(n).replace(/\n$/,"")}):t?(0,r.jsx)("code",{className:"".concat(l," px-1.5 py-0.5 bg-muted rounded text-sm font-mono"),...i,children:n}):(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("button",{onClick:x,className:"absolute top-2 right-2 p-1 rounded bg-muted/80 hover:bg-muted opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy code",children:o?(0,r.jsx)(u.Z,{className:"w-3 h-3 text-green-500"}):(0,r.jsx)(ev.Z,{className:"w-3 h-3 text-muted-foreground"})}),(0,r.jsx)(eg.Z,{style:ep.Z,language:c&&c[1],PreTag:"div",className:"!m-0 !p-3 !rounded-md !text-sm",...i,children:String(n).replace(/\n$/,"")})]})};function ek(e){let{message:s}=e,t="user"===s.role,a=!t&&s.content.includes("I've generated a complete SOW");return(0,r.jsxs)("div",{className:"flex gap-3 ".concat(t?"justify-end":"justify-start"),children:[(0,r.jsx)("div",{className:"flex-shrink-0 ".concat(t?"order-2":"order-1"),children:(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center shadow-sm ".concat(t?"bg-gradient-to-br from-blue-500 to-blue-600":"bg-gradient-to-br from-[#20e28f] to-[#1bc47d]"),children:t?(0,r.jsx)(eN.Z,{className:"w-4 h-4 text-white"}):(0,r.jsx)(W.Z,{className:"w-4 h-4 text-white"})})}),(0,r.jsxs)("div",{className:"flex flex-col gap-1 max-w-[75%] ".concat(t?"order-1":"order-2"),children:[(0,r.jsx)("div",{className:"px-4 py-3 rounded-2xl shadow-sm ".concat(t?"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-br-md":"bg-card border text-foreground rounded-bl-md"),children:(0,r.jsx)("div",{className:"text-sm leading-relaxed",children:(0,r.jsx)(eh.UG,{remarkPlugins:[ef.Z],components:{code:ey,p:e=>{let{children:s}=e;return(0,r.jsx)("p",{className:"mb-3 last:mb-0 leading-relaxed",children:s})},ul:e=>{let{children:s}=e;return(0,r.jsx)("ul",{className:"list-disc list-inside mb-3 space-y-2 ml-2",children:s})},ol:e=>{let{children:s}=e;return(0,r.jsx)("ol",{className:"list-decimal list-inside mb-3 space-y-2 ml-2",children:s})},li:e=>{let{children:s}=e;return(0,r.jsx)("li",{className:"text-sm leading-relaxed",children:s})},h1:e=>{let{children:s}=e;return(0,r.jsx)("h1",{className:"text-lg font-semibold mb-3 mt-4 text-primary border-b border-border pb-1",children:s})},h2:e=>{let{children:s}=e;return(0,r.jsx)("h2",{className:"text-base font-semibold mb-2 mt-3 text-primary/90",children:s})},h3:e=>{let{children:s}=e;return(0,r.jsx)("h3",{className:"text-sm font-semibold mb-2 mt-2 text-primary/80",children:s})},blockquote:e=>{let{children:s}=e;return(0,r.jsx)("blockquote",{className:"border-l-4 border-primary/30 pl-4 pr-2 py-2 italic text-muted-foreground bg-muted/20 my-3 rounded-r-md",children:s})},table:e=>{let{children:s}=e;return(0,r.jsx)("div",{className:"overflow-x-auto mb-2",children:(0,r.jsx)("table",{className:"min-w-full border-collapse border border-border rounded-md text-xs",children:s})})},thead:e=>{let{children:s}=e;return(0,r.jsx)("thead",{className:"bg-muted/50",children:s})},tbody:e=>{let{children:s}=e;return(0,r.jsx)("tbody",{children:s})},tr:e=>{let{children:s}=e;return(0,r.jsx)("tr",{className:"border-b border-border hover:bg-muted/20",children:s})},th:e=>{let{children:s}=e;return(0,r.jsx)("th",{className:"px-3 py-2 text-left text-sm font-semibold border-r border-border last:border-r-0",children:s})},td:e=>{let{children:s}=e;return(0,r.jsx)("td",{className:"px-3 py-2 text-sm border-r border-border last:border-r-0",children:s})},strong:e=>{let{children:s}=e;return(0,r.jsx)("strong",{className:"font-semibold text-foreground",children:s})},em:e=>{let{children:s}=e;return(0,r.jsx)("em",{className:"italic text-muted-foreground",children:s})},hr:()=>(0,r.jsx)("hr",{className:"my-4 border-border"}),a:e=>{let{href:s,children:t}=e;return(0,r.jsx)("a",{href:s,className:"text-primary hover:text-primary/80 underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:t})}},children:s.content})})}),!t&&s.architectsLog&&s.architectsLog.length>0&&(0,r.jsx)(eS,{architectsLog:s.architectsLog}),a&&(0,r.jsx)("div",{className:"mt-2 flex justify-start",children:(0,r.jsxs)("button",{onClick:()=>{},className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-[#20e28f] to-[#1bc47d] hover:from-[#1bc47d] hover:to-[#20e28f] text-white font-medium rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200",children:[(0,r.jsx)(ew.Z,{className:"w-4 h-4"}),"View in Editor"]})})]})]})}function eS(e){let{architectsLog:s}=e,[t,l]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"mt-3 border border-border/50 rounded-lg bg-muted/20 overflow-hidden",children:[(0,r.jsxs)("button",{onClick:()=>l(!t),className:"w-full px-3 py-2 text-left flex items-center justify-between text-xs font-medium text-muted-foreground hover:bg-muted/30 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T.Z,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:"Architect's Log"}),(0,r.jsxs)("span",{className:"text-[10px] bg-muted px-1.5 py-0.5 rounded-full",children:[s.length," insights"]})]}),t?(0,r.jsx)(k.Z,{className:"w-3 h-3"}):(0,r.jsx)(S.Z,{className:"w-3 h-3"})]}),t&&(0,r.jsxs)("div",{className:"px-3 pb-3 space-y-2",children:[(0,r.jsx)("div",{className:"text-[10px] text-muted-foreground/70 mb-2 italic",children:"AI's reasoning and decision process:"}),s.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start gap-2 text-xs",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-primary/60 mt-1.5 flex-shrink-0"}),(0,r.jsx)("span",{className:"text-foreground/80 leading-relaxed",children:e})]},s))]})]})}var eC=t(24691);function ez(e){let{readOnly:s=!1}=e,{activeSow:t,isTyping:l}=(0,n.m)(),i=(0,a.useRef)(null),o=(0,a.useRef)(null),d=()=>{if(o.current){let e=o.current.querySelector("[data-radix-scroll-area-viewport]");e&&(e.scrollTop=e.scrollHeight)}};(0,a.useEffect)(()=>{let e=setTimeout(d,100);return()=>clearTimeout(e)},[null==t?void 0:t.messages]);let c=(null==t?void 0:t.messages)&&t.messages.length>0;return(0,r.jsx)(eC.x,{ref:o,className:"flex-1 h-full",children:(0,r.jsxs)("div",{className:"p-3 space-y-3 min-h-full",children:[!c&&(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center p-6 min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center space-y-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-muted flex items-center justify-center mx-auto",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-foreground",children:"Start a conversation"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:'Ask me about your project or say "hi" to get started'})]})]})}),c&&t.messages.map(e=>(0,r.jsx)("div",{children:(0,r.jsx)(ek,{message:e})},e.id)),l&&(0,r.jsxs)("div",{className:"flex gap-3 justify-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-muted",children:(0,r.jsx)(W.Z,{className:"w-4 h-4 text-muted-foreground"})})}),(0,r.jsx)("div",{className:"flex flex-col gap-1 max-w-[75%]",children:(0,r.jsx)("div",{className:"bg-card border rounded-2xl px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-pulse"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,r.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-pulse",style:{animationDelay:"0.4s"}}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground ml-2",children:"AI Architect is thinking..."})]})})})]}),(0,r.jsx)("div",{ref:i})]})})}var eZ=t(43663),eD=t(36957),eA=t(77528);let eO=[{id:"buildsow",command:"/buildsow",description:"Generate complete SOW from conversation",icon:(0,r.jsx)(eD.Z,{className:"w-4 h-4"}),example:"/buildsow"},{id:"newscope",command:"/newScope",description:"Add a new scope to current SOW",icon:(0,r.jsx)(g.Z,{className:"w-4 h-4"}),example:"/newScope Website Design"},{id:"addrole",command:"/addRole",description:"Add role to specific scope",icon:(0,r.jsx)(eA.Z,{className:"w-4 h-4"}),example:"/addRole to 1 Designer 40"},{id:"setbudget",command:"/setBudget",description:"Set project budget target",icon:(0,r.jsx)(w.Z,{className:"w-4 h-4"}),example:"/setBudget 25000"}];function eE(e){let{isVisible:s,onSelect:t,onClose:l,filter:n}=e,[i,o]=(0,a.useState)(0),m=(0,a.useRef)(null),x=eO.filter(e=>e.command.toLowerCase().includes(n.toLowerCase())||e.description.toLowerCase().includes(n.toLowerCase()));return((0,a.useEffect)(()=>{o(0)},[n]),(0,a.useEffect)(()=>{let e=e=>{if(s)switch(e.key){case"ArrowDown":e.preventDefault(),o(e=>(e+1)%x.length);break;case"ArrowUp":e.preventDefault(),o(e=>(e-1+x.length)%x.length);break;case"Enter":e.preventDefault(),x[i]&&t(x[i].command);break;case"Escape":e.preventDefault(),l()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s,i,x,t,l]),s&&0!==x.length)?(0,r.jsx)(c.Zb,{ref:m,className:"absolute bottom-full left-0 mb-2 w-80 max-h-64 overflow-y-auto shadow-lg border bg-popover z-50",children:(0,r.jsxs)("div",{className:"p-2",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-muted-foreground px-2 py-1 mb-1",children:"Slash Commands"}),x.map((e,s)=>(0,r.jsx)(d.z,{variant:s===i?"secondary":"ghost",className:"w-full justify-start h-auto p-3 mb-1",onClick:()=>t(e.command),children:(0,r.jsxs)("div",{className:"flex items-start gap-3 w-full",children:[(0,r.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:e.icon}),(0,r.jsxs)("div",{className:"flex-1 text-left",children:[(0,r.jsx)("div",{className:"font-medium text-sm",children:e.command}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground line-clamp-1",children:e.description}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground/60 mt-1 font-mono",children:e.example})]})]})},e.id))]})}):null}function eL(e){var s;let{mode:t}=e,{sendMessage:l}=(0,n.m)(),[i,o]=(0,a.useState)(""),[c,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(!1),[h,f]=(0,a.useState)(!1),[g,p]=(0,a.useState)(""),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=await fetch("/api/settings/selectedModel");if(e.ok){let s=await e.json();s.model&&(p(s.model),console.log("Loaded saved model:",s.model))}}catch(e){console.error("Failed to load selected model:",e)}},b=async e=>{try{(await fetch("/api/settings/selectedModel",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:e})})).ok&&(p(e),f(!1),console.log("Model saved successfully:",e))}catch(e){console.error("Failed to save selected model:",e)}},N=async()=>{if(i.trim()&&!c){m(!0);try{await l(i),o(""),j.current&&(j.current.style.height="36px")}catch(e){console.error("Failed to send message:",e)}finally{m(!1)}}};return(0,r.jsxs)("div",{children:[h&&(0,r.jsxs)("div",{className:"bg-card border border-border rounded-lg p-4 shadow-lg",children:[(0,r.jsx)(A.f,{selectedModel:g,onModelChange:p,onSave:()=>b(g),showSaveButton:!0}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>f(!1),className:"mt-2 w-full",children:"Close"})]}),(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsx)(d.z,{onClick:()=>f(!h),variant:"outline",size:"sm",className:"h-[44px] px-3 rounded-lg bg-background border-2 border-input hover:bg-accent hover:border-emerald-400/50 transition-all duration-200",title:"Select AI Model",children:(0,r.jsx)(W.Z,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("textarea",{ref:j,value:i,onChange:e=>{let s=e.target.value;o(s);let t=e.target.selectionStart,r=s.substring(0,t).split(/\s+/).pop()||"";if(u(r.startsWith("/")&&r.length>0),j.current){j.current.style.height="36px";let e=j.current.scrollHeight;j.current.style.height="".concat(Math.min(Math.max(e,36),72),"px")}},onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N())},placeholder:"✨ Ask me about your project or say 'hi' to get started...",className:"w-full resize-none rounded-lg border-2 bg-background backdrop-blur-sm px-4 py-3 pr-10 text-sm font-medium text-foreground placeholder:text-muted-foreground/70 focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 hover:border-emerald-400/50 transition-all duration-200 disabled:cursor-not-allowed disabled:opacity-50 shadow-sm hover:shadow-md",rows:1,style:{minHeight:"44px",maxHeight:"88px",lineHeight:"1.5",overflowY:i.split("\n").length>2?"auto":"hidden"},disabled:c}),i.trim()&&(0,r.jsx)("div",{className:"absolute bottom-2 right-2 opacity-50 hover:opacity-70 transition-opacity",children:(0,r.jsx)("kbd",{className:"px-2 py-1 text-xs bg-emerald-100 text-emerald-700 rounded-md font-medium shadow-sm",children:"Enter ↵"})}),(0,r.jsx)(eE,{isVisible:x,onSelect:e=>{var s;let t=(null===(s=j.current)||void 0===s?void 0:s.selectionStart)||0,r=i.substring(0,t),a=i.substring(t),l=r.split(/\s+/),n=l[l.length-1];if(n.startsWith("/")){let s=r.substring(0,r.length-n.length);o(s+e+" "+a),setTimeout(()=>{if(j.current){let t=s.length+e.length+1;j.current.setSelectionRange(t,t),j.current.focus()}},0)}u(!1)},onClose:()=>{u(!1)},filter:(null===(s=i.split(/\s+/).pop())||void 0===s?void 0:s.substring(1))||""})]}),(0,r.jsx)(d.z,{onClick:N,disabled:!i.trim()||c,className:"px-4 py-3 h-[44px] rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 flex-shrink-0 disabled:opacity-50 disabled:hover:transform-none",size:"sm",children:c?(0,r.jsx)(M.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(eZ.Z,{className:"h-4 w-4"})})]})]})}var eT=t(69697);function eF(){let{activeSow:e,updateActiveSowName:s,isSaving:t,toggleSidebar:l,toggleChatPanel:i,sidebarVisible:o}=(0,n.m)(),[c,m]=(0,a.useState)("editor"),x=async()=>{if(e)try{await (0,eT.F)(e)}catch(e){console.error("Failed to export PDF:",e)}};return(0,r.jsx)("div",{className:"flex-1 flex h-screen",children:(0,r.jsx)(r.Fragment,{children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,r.jsx)("div",{className:"flex border-b px-4 py-2 items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:l,className:"mr-2 p-2",title:o?"Hide sidebar":"Show sidebar",children:o?(0,r.jsx)(O.Z,{className:"h-4 w-4"}):(0,r.jsx)(E.Z,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mr-4",children:[(0,r.jsxs)(d.z,{variant:"outline",size:"sm",onClick:x,disabled:!e,className:"flex items-center gap-2",children:[(0,r.jsx)(L.Z,{className:"h-4 w-4"}),"PDF"]}),(0,r.jsxs)(d.z,{variant:"outline",size:"sm",onClick:()=>{if(e)try{(0,eT.z)(e)}catch(e){console.error("Failed to export XLSX:",e)}},disabled:!e,className:"flex items-center gap-2",children:[(0,r.jsx)(T.Z,{className:"h-4 w-4"}),"Excel"]})]}),(0,r.jsxs)("button",{onClick:()=>m("conversation"),className:"flex items-center gap-2 px-6 py-3 text-sm font-medium border-b-2 ".concat("conversation"===c?"border-primary text-primary bg-primary/5":"border-transparent text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:[(0,r.jsx)(F.Z,{className:"w-4 h-4"}),"Conversation"]}),(0,r.jsxs)("button",{onClick:()=>m("editor"),className:"flex items-center gap-2 px-6 py-3 text-sm font-medium border-b-2 ".concat("editor"===c?"border-primary text-primary bg-primary/5":"border-transparent text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:[(0,r.jsx)(I.Z,{className:"w-4 h-4"}),"Editor"]})]})}),"                ",(0,r.jsx)("div",{className:"flex-1 overflow-y-auto",children:"editor"===c?(0,r.jsx)(eu,{}):(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsx)("div",{className:"p-4 border-b bg-muted/30",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center",children:(0,r.jsx)(W.Z,{className:"w-4 h-4 text-muted-foreground"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-foreground",children:"Conversation History"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Review your project planning discussion"})]})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)("div",{className:"h-full overflow-y-auto",children:(0,r.jsx)(ez,{readOnly:!0})})})]})})]}),(0,r.jsx)("div",{className:"w-96 border-l bg-card flex flex-col",children:(0,r.jsx)(eI,{forceVisible:!0})})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(T.Z,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"No SOW Selected"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Select an existing SOW from the sidebar or create a new one to get started."})]})})})})}function eI(e){let{forceVisible:s=!1}=e,{chatPanelVisible:t,toggleChatPanel:a,isLoading:l}=(0,n.m)();return s||t?(0,r.jsxs)("div",{className:"w-full border-l bg-card flex flex-col h-full shadow-xl",children:[(0,r.jsx)("div",{className:"flex-shrink-0 border-b bg-card/95 backdrop-blur-sm",children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-[#20e28f] to-[#1bc47d] flex items-center justify-center shadow-md",children:(0,r.jsx)(W.Z,{className:"w-4 h-4 text-white"})}),(0,r.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-400 rounded-full border border-background animate-pulse"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-foreground",children:"AI Assistant"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Project planning & SOW generation"})]})]}),(0,r.jsx)(d.z,{variant:"ghost",size:"sm",onClick:a,className:"hover:bg-accent transition-colors",title:"Close chat panel",children:(0,r.jsx)(R.Z,{className:"h-4 w-4"})})]})})}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",style:{maxHeight:"calc(100vh - 200px)"},children:l?(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"text-center space-y-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#20e28f] to-[#1bc47d] flex items-center justify-center shadow-md",children:(0,r.jsx)(M.Z,{className:"h-6 w-6 animate-spin text-white"})}),(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-[#20e28f] to-[#1bc47d] animate-ping opacity-20"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-foreground",children:"AI Assistant is thinking..."}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Processing your request"})]})]})}):(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(ez,{})})}),(0,r.jsxs)("div",{className:"flex-shrink-0 border-t bg-card p-2",children:[(0,r.jsx)(eL,{}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground/60 mt-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)("kbd",{className:"px-1 py-0.5 bg-muted rounded text-xs",children:"Enter"}),"Send"]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)("kbd",{className:"px-1 py-0.5 bg-muted rounded text-xs",children:"/buildsow"}),"Generate"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{className:"text-xs hover:text-foreground px-1 py-0.5 rounded hover:bg-muted",children:"New Chat"}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("button",{className:"text-xs hover:text-foreground px-1 py-0.5 rounded hover:bg-muted",children:"Reset"})]})]})]})]}):null}function eW(){let{fetchSows:e,fetchRateCard:s,createSow:t,selectSow:i,activeSow:o,updateActiveSowData:d,sidebarVisible:c,chatPanelVisible:m,toggleChatPanel:x}=(0,n.m)();(0,a.useEffect)(()=>{(async()=>{if(await e(),await s(),!o)try{let e=await t();await i(e.id)}catch(e){console.error("Failed to create initial SOW:",e)}})()},[e,s,t,i,o]);let u=(0,l.y1)(async e=>{if(e&&o){console.log("Auto-saving SOW to database...");try{await d(e),console.log("Auto-save successful")}catch(e){console.error("Failed to auto-save:",e)}}},1500);return(0,a.useEffect)(()=>{(null==o?void 0:o.sowData)&&u(o.sowData)},[null==o?void 0:o.sowData,u]),(0,r.jsxs)("div",{className:"min-h-screen flex bg-background",children:[(0,r.jsx)("div",{className:c?"":"hidden",children:(0,r.jsx)(D,{})}),(0,r.jsx)(eF,{})]})}},90024:function(e,s,t){"use strict";t.d(s,{f:function(){return d}});var r=t(69245),a=t(69703),l=t(89619),n=t(34673),i=t(28251),o=t(2979);function d(e){var s;let{selectedModel:t,onModelChange:d,onSave:c,showSaveButton:m=!1}=e,[x,u]=(0,a.useState)([]),[h,f]=(0,a.useState)(""),[g,p]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[b,N]=(0,a.useState)(!0),[w,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{k()},[]);let k=async()=>{try{N(!0),y(null);let e=await fetch("/api/ai/models");if(e.ok){let s=await e.json();console.log("Loaded AI models:",s.length),u(s)}else y("Failed to load models")}catch(e){console.error("Failed to load AI models:",e),y("Network error")}finally{N(!1)}},S=x.filter(e=>(""===h||e.displayName.toLowerCase().includes(h.toLowerCase()))&&(!g||e.id.includes(":free"))),C=b?"Loading models...":w?"Error loading models":(null===(s=x.find(e=>e.id===t))||void 0===s?void 0:s.displayName)||"Select AI model...";return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"AI Model"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>v(!j),disabled:0===x.length,className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[C,j?(0,r.jsx)(i.Z,{className:"h-4 w-4"}):(0,r.jsx)(o.Z,{className:"h-4 w-4"})]}),j&&(0,r.jsxs)("div",{className:"absolute z-50 w-full bg-background border border-input rounded-md shadow-md mt-1 p-2",children:[(0,r.jsx)(n.I,{placeholder:"Search models...",value:h,onChange:e=>f(e.target.value),className:"mb-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"free-toggle",checked:g,onChange:e=>p(e.target.checked)}),(0,r.jsx)("label",{htmlFor:"free-toggle",className:"text-sm",children:"Show free models only"})]}),(0,r.jsx)("div",{className:"max-h-40 overflow-y-auto",children:0===S.length?(0,r.jsx)("div",{className:"px-2 py-3 text-sm text-muted-foreground text-center",children:0===x.length?"Loading models...":"No models found"}):S.map(e=>(0,r.jsx)("button",{className:"w-full px-2 py-1 text-left hover:bg-accent hover:text-accent-foreground rounded",onClick:()=>{d(e.id),v(!1)},children:e.displayName},e.id))})]})]}),m&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Currently selected: ",C]}),(0,r.jsx)(l.z,{onClick:c,disabled:""===t,children:"Save Model"})]})]})}},24691:function(e,s,t){"use strict";t.d(s,{x:function(){return i}});var r=t(69245),a=t(69703),l=t(33061),n=t(1917);let i=a.forwardRef((e,s)=>{let{className:t,children:a,...i}=e;return(0,r.jsxs)(l.fC,{ref:s,className:(0,n.cn)("relative overflow-hidden",t),...i,children:[(0,r.jsx)(l.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(o,{}),(0,r.jsx)(l.Ns,{})]})});i.displayName=l.fC.displayName;let o=a.forwardRef((e,s)=>{let{className:t,orientation:a="vertical",...i}=e;return(0,r.jsx)(l.gb,{ref:s,orientation:a,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 border-t border-t-transparent p-[1px]",t),...i,children:(0,r.jsx)(l.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=l.gb.displayName}},function(e){e.O(0,[955,509,877,530,271,301,340,441,321,433,744],function(){return e(e.s=98748)}),_N_E=e.O()}]);