(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[441],{21916:function(){},36460:function(){},18535:function(n,e,t){"use strict";t.d(e,{_:function(){return c}});var o=t(69245),i=t(69703),a=t(87786),r=t(22131),s=t(1917);let l=(0,r.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=i.forwardRef((n,e)=>{let{className:t,...i}=n;return(0,o.jsx)(a.f,{ref:e,className:(0,s.cn)(l(),t),...i})});c.displayName=a.f.displayName},44636:function(n,e,t){"use strict";t.d(e,{g:function(){return r}});var o=t(69245),i=t(69703),a=t(1917);let r=i.forwardRef((n,e)=>{let{className:t,...i}=n;return(0,o.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:e,...i})});r.displayName="Textarea"},69697:function(n,e,t){"use strict";t.d(e,{F:function(){return l},z:function(){return c}});var o=t(58553);function i(n){if(!n)return"";let e=n.split(/\+|\n/).map(n=>n.trim()).filter(n=>n.length>0);return e.length<=1?n:"<ul>".concat(e.map(n=>"<li>".concat(n,"</li>")).join(""),"</ul>")}let a={primary:"#0e2e33",accent:"#20e28f",text:"#2d3748",lightGray:"#f8fafc"};async function r(){try{let n=await fetch("/api/settings");if(n.ok)return await n.json()}catch(n){console.error("Failed to fetch brand settings:",n)}return{companyName:"Social Garden",logoUrl:"",primaryColor:"#0e2e33",secondaryColor:"#16803d",accentColor:"#20e28f",fontFamily:"Plus Jakarta Sans",fontSize:"14"}}let s=(n,e)=>{var t,o,r,s;let l=n.sowData,c={primary:(null==e?void 0:e.primaryColor)||a.primary,accent:(null==e?void 0:e.accentColor)||a.accent,text:a.text,lightGray:a.lightGray},d=(null==e?void 0:e.logoUrl)||"https://i.ibb.co/4gtm4Xm0/Logo-Dark-Green.png";return null==e||e.fontFamily,'\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="utf-8">\n      <base href="https://demo.qandu.me/" />\n      <link rel="preconnect" href="https://fonts.googleapis.com">\n      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>\n      <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">\n      <style>\n        @import url(\'https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700;800&display=swap\');\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        \n        body {\n          font-family: \'Plus Jakarta Sans\', -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n          line-height: 1.6;\n          color: '.concat(c.text,";\n          background: white;\n        }\n        \n        .container {\n          max-width: 800px;\n          margin: 0 auto;\n          padding: 40px;\n        }\n        \n        .header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 50px;\n          padding-bottom: 30px;\n          border-bottom: 3px solid ").concat(c.accent,";\n        }\n        \n        .logo {\n          width: 180px;\n          height: auto;\n        }\n        \n        .header-text {\n          text-align: right;\n        }\n        \n        .header-title {\n          font-size: 24px;\n          font-weight: 700;\n          color: ").concat(c.primary,";\n          margin-bottom: 5px;\n        }\n        \n        .header-subtitle {\n          font-size: 14px;\n          color: ").concat(c.text,";\n          opacity: 0.8;\n        }\n        \n        .project-header {\n          background: linear-gradient(135deg, ").concat(c.primary," 0%, #1a4a52 100%);\n          color: white;\n          padding: 30px;\n          border-radius: 12px;\n          margin-bottom: 40px;\n        }\n        \n        .project-title {\n          font-size: 28px;\n          font-weight: 700;\n          margin-bottom: 10px;\n        }\n        \n        .project-client {\n          font-size: 16px;\n          opacity: 0.9;\n          margin-bottom: 20px;\n        }\n        \n        .section {\n          margin-bottom: 35px;\n        }\n        \n        .section-title {\n          font-size: 18px;\n          font-weight: 600;\n          color: ").concat(c.primary,";\n          margin-bottom: 15px;\n          padding-bottom: 8px;\n          border-bottom: 2px solid ").concat(c.accent,";\n          display: inline-block;\n        }\n        \n        .section-content {\n          font-size: 14px;\n          line-height: 1.7;\n        }\n        \n        .scope {\n          background: ").concat(c.lightGray,";\n          border-radius: 10px;\n          padding: 25px;\n          margin-bottom: 25px;\n          border-left: 4px solid ").concat(c.accent,";\n        }\n        \n        .scope-title {\n          font-size: 20px;\n          font-weight: 600;\n          color: ").concat(c.primary,";\n          margin-bottom: 15px;\n        }\n        \n        .scope-overview {\n          font-size: 14px;\n          margin-bottom: 20px;\n          line-height: 1.6;\n        }\n        \n        .roles-table {\n          width: 100%;\n          border-collapse: collapse;\n          margin: 20px 0;\n          background: white;\n          border-radius: 8px;\n          overflow: hidden;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .roles-table th {\n          background: ").concat(c.primary,";\n          color: white;\n          padding: 12px 15px;\n          text-align: left;\n          font-weight: 600;\n          font-size: 14px;\n        }\n        \n        .roles-table td {\n          padding: 12px 15px;\n          border-bottom: 1px solid #e5e7eb;\n          font-size: 14px;\n        }\n        \n        .roles-table td:nth-child(3),\n        .roles-table td:nth-child(4),\n        .roles-table td:nth-child(5) {\n          text-align: right;\n          font-weight: 600;\n        }\n        \n        .roles-table tr:nth-child(even) {\n          background: #f9fafb;\n        }\n        \n        .subtotal {\n          text-align: right;\n          font-weight: 600;\n          color: ").concat(c.primary,";\n          font-size: 16px;\n          margin-top: 15px;\n          padding: 15px;\n          background: white;\n          border-radius: 8px;\n          border: 2px solid ").concat(c.accent,";\n        }\n        \n        .deliverables, .assumptions {\n          background: white;\n          padding: 20px;\n          border-radius: 8px;\n          margin: 15px 0;\n          border-left: 4px solid ").concat(c.accent,";\n        }\n        \n        .deliverables ul, .assumptions ul {\n          list-style-type: disc;\n          margin-left: 20px;\n          margin-top: 8px;\n        }\n        \n        .deliverables li, .assumptions li {\n          margin-bottom: 8px;\n          line-height: 1.6;\n        }\n        \n        .footer {\n          margin-top: 60px;\n          padding-top: 30px;\n          border-top: 2px solid ").concat(c.accent,";\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n        \n        .footer-text {\n          font-size: 10px;\n          color: ").concat(c.text,';\n          flex: 1;\n        }\n        \n        @media print {\n          .container { padding: 20px; }\n          .project-header { break-inside: avoid; }\n          .scope { break-inside: avoid; }\n        }\n      </style>\n    </head>\n    <body>\n      <div class="container">\n        <!-- Header with Logo -->\n        <div class="header">\n          <img src="').concat(d,'" alt="Logo" class="logo" />\n          <div class="header-text">\n            <div class="header-title">Statement of Work</div>\n            <div class="header-subtitle">Professional Services Agreement</div>\n          </div>\n        </div>\n        \n        <!-- Project Header -->\n        <div class="project-header">\n          <div class="project-title">').concat((null==l?void 0:l.projectTitle)||"Untitled Project",'</div>\n          <div class="project-client">Client: ').concat((null==l?void 0:l.clientName)||"Not specified","</div>\n        </div>\n        \n        <!-- Project Overview -->\n        ").concat((null==l?void 0:l.projectOverview)?'\n        <div class="section">\n          <div class="section-title">Project Overview</div>\n          <div class="section-content">'.concat(l.projectOverview,"</div>\n        </div>\n        "):"","\n        \n        <!-- Project Outcomes -->\n        ").concat((null==l?void 0:null===(t=l.projectOutcomes)||void 0===t?void 0:t.length)?'\n        <div class="section">\n          <div class="section-title">Project Outcomes</div>\n          <div class="section-content">\n            '.concat(l.projectOutcomes.map((n,e)=>'<div style="margin-bottom: 8px;">'.concat(e+1,". ").concat(n,"</div>")).join(""),"\n          </div>\n        </div>\n        "):"","\n        \n        <!-- Scopes -->\n        ").concat((null==l?void 0:null===(o=l.scopes)||void 0===o?void 0:o.map((n,e)=>{var t,o;return'\n        <div class="scope">\n          <div class="scope-title">Scope '.concat(e+1,": ").concat(n.scopeName,"</div>\n          ").concat(n.scopeOverview?'<div class="scope-overview">'.concat(n.scopeOverview,"</div>"):"","\n          \n          ").concat(n.deliverables?'\n          <div class="deliverables">\n            <strong>Deliverables:</strong>\n            <div style="margin-top: 8px;">'.concat(i(n.deliverables),"</div>\n          </div>\n          "):"","\n\n          ").concat((null===(t=n.roles)||void 0===t?void 0:t.length)?'\n          <table class="roles-table">\n            <thead>\n              <tr>\n                <th>Role</th>\n                <th>Hours</th>\n                <th>Rate</th>\n                <th>Total</th>\n              </tr>\n            </thead>\n            <tbody>\n              '.concat(n.roles.map(n=>"\n              <tr>\n                <td>".concat(n.name||"Unnamed Role","</td>\n                <td>").concat(n.hours||0,"</td>\n                <td>$").concat(n.rate||0,"</td>\n                <td>$").concat(n.total||0,"</td>\n              </tr>\n              ")).join(""),"\n            </tbody>\n          </table>\n          ").concat(n.subtotal?'<div class="subtotal">Scope Subtotal: $'.concat(n.subtotal.toFixed(2),"</div>"):"","\n          "):"","          ").concat((null===(o=n.assumptions)||void 0===o?void 0:o.length)?'\n          <div class="assumptions">\n            <strong>Assumptions:</strong>\n            '.concat(i(n.assumptions.join(" + ")),"\n          </div>\n          "):"","\n        </div>\n        ")}).join(""))||"","\n        \n        <!-- Budget Notes -->\n        ").concat((null==l?void 0:l.budgetNote)||(null==l?void 0:null===(r=l.scopes)||void 0===r?void 0:r.length)?'\n        <div class="section">\n          <div class="section-title">Budget Notes</div>\n          <div class="section-content">\n            <strong>Total Investment:</strong> $'.concat((null==l?void 0:null===(s=l.scopes)||void 0===s?void 0:s.reduce((n,e)=>n+(e.subtotal||0),0).toLocaleString())||"0"," (including GST)<br><br>\n            ").concat((null==l?void 0:l.budgetNote)||"This scope has been carefully crafted to deliver maximum ROI while maintaining the highest quality standards.","\n          </div>\n        </div>\n        "):"","\n        \n      </div>\n    </body>\n    </html>\n  ")};async function l(n){try{console.log("\uD83C\uDFA8 Generating PDF (Puppeteer) with brand settings");let e=await r(),t=s(n,e);console.log("\uD83D\uDCC4 Generated HTML template"),console.log("\uD83D\uDE80 Sending to PDF export API...");let o="".concat(n.name||"SOW","_Export_").concat(new Date().toISOString().split("T")[0],".pdf");try{let n=await fetch("/api/export/pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:t,filename:o})});if(n.ok){console.log("✅ PDF generated successfully via Puppeteer!");let e=await n.blob(),t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download=o,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(t);return}throw Error("PDF service returned non-ok response")}catch(n){console.warn("⚠️ PDF service unavailable or failed, using browser fallback",n)}console.log("\uD83D\uDDA8️ Using browser print fallback...");let i=window.open("","_blank");if(!i)throw Error("Popup blocked - please allow popups and try again");i.document.write(t),i.document.close(),i.onload=()=>{setTimeout(()=>{i.print(),setTimeout(()=>{i.close()},1e3)},500)},console.log("✅ Browser print dialog opened!")}catch(n){console.error("Error generating PDF:",n),alert("Failed to generate PDF. Please try again or check if popups are blocked.")}}function c(n){try{var e,t,i;let a=n.sowData,r=o.P6.book_new(),s=[["","","","","","",""],["","","","","","",""],["","","SOCIAL GARDEN","","","",""],["","","","","","",""],["","Marketing Automation","Customer Journey Mapping","Services","","",""],["","","","","","",""],["ITEMS","","","ROLE","","HOURS","TOTAL COST + GST"],["","","","","","",""]];(null==a?void 0:a.scopes)&&Array.isArray(a.scopes)&&a.scopes.forEach((n,e)=>{if(s.push([n.scopeName,"","","","","",""]),s.push(["","","","","","",""]),n.deliverables&&(Array.isArray(n.deliverables)?n.deliverables.length>0:n.deliverables.trim().length>0)){s.push(["","","","","","",""]);let e=Array.isArray(n.deliverables)?n.deliverables.join(", "):n.deliverables.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").trim();s.push(["Deliverables:",e,"","","","",""])}n.roles&&Array.isArray(n.roles)&&n.roles.forEach(n=>{s.push([n.description||n.name||"Service Item","","",n.name||"Role","",n.hours||0,"$".concat((n.total||0).toLocaleString())])}),n.assumptions&&n.assumptions.length>0&&(s.push(["","","","","","",""]),s.push(["Assumptions:",n.assumptions.join(", "),"","","","",""])),s.push(["","","","","","",""])});let l=(null==a?void 0:null===(e=a.scopes)||void 0===e?void 0:e.reduce((n,e)=>n+(e.subtotal||0),0))||0;s.push(["TOTAL","","","","","","$".concat(l.toLocaleString())]);let c=o.P6.aoa_to_sheet(s);c["!cols"]=[{wch:40},{wch:10},{wch:15},{wch:25},{wch:5},{wch:10},{wch:15}],o.P6.book_append_sheet(r,c,"Detailed Breakdown");let d=[["","","",""],["","","",""],["SOCIAL GARDEN","","",""],["","","",""],["Marketing Automation | Advisory & Consultation | Services","","",""],["","","",""],["Overview:","","",""],[(null==a?void 0:a.projectOverview)||"This scope of work details a proposed solution for Social Garden to support the client with Marketing Automation advisory and consultation services related to customer journey mapping","","",""],["","","",""],["What does the scope include?","","",""],["• Customer Journey Mapping","","",""],["","","",""],["Project Phases:","","",""],["• Discovery & Analysis","","",""],["• Technical Assessment & Orchestration Mapping","","",""],["• Final Delivery & Handover","","",""],["","","",""],["Scope & Pricing Overview","","",""],["","","",""],["PROJECT PHASES","TOTAL HOURS","AVG. HOURLY RATE","TOTAL COST"]];(null==a?void 0:a.scopes)&&Array.isArray(a.scopes)&&a.scopes.forEach(n=>{var e;let t=(null===(e=n.roles)||void 0===e?void 0:e.reduce((n,e)=>n+(e.hours||0),0))||0,o=t>0?Math.round((n.subtotal||0)/t):0;d.push([n.scopeName,t.toString(),"$".concat(o),"$".concat((n.subtotal||0).toLocaleString())])});let p=(null==a?void 0:null===(t=a.scopes)||void 0===t?void 0:t.reduce((n,e)=>{var t;return n+((null===(t=e.roles)||void 0===t?void 0:t.reduce((n,e)=>n+(e.hours||0),0))||0)},0))||0,u=(null==a?void 0:null===(i=a.scopes)||void 0===i?void 0:i.reduce((n,e)=>n+(e.subtotal||0),0))||0;d.push(["TOTAL PROJECT",p.toString(),"","$".concat(u.toLocaleString())]);let g=o.P6.aoa_to_sheet(d);g["!cols"]=[{wch:40},{wch:15},{wch:15},{wch:15}],o.P6.book_append_sheet(r,g,"Scope & Price Overview");let h="".concat(n.name||"SOW","_SocialGarden_").concat(new Date().toISOString().split("T")[0],".xlsx");o.NC(r,h)}catch(n){console.error("Error generating XLSX:",n),alert("Failed to generate Excel file. Please try again.")}}}}]);